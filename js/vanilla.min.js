"use strict";document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.oncontextmenu=()=>!1;class Calculator{constructor(){this.inputArray=[],this.tempOperator="",this.inputElement=document.querySelector(".input"),this.resultElement=document.querySelector(".result"),this.btnElements=document.querySelectorAll(".btn"),this.textviewElement=document.querySelector(".textview"),this.clickSound=new Audio("https://github.com/raychang2017/f2e-portfolio/blob/master/08%20-%20%E5%81%9A%E4%B8%80%E5%80%8B%E5%84%AA%E9%9B%85%E7%9A%84%20Vanilla%20JS%20%E8%A8%88%E7%AE%97%E6%A9%9F%EF%BC%8C%E5%8D%B3%E6%99%82%E9%A1%AF%E7%A4%BA%E8%A8%88%E7%AE%97%E7%B5%90%E6%9E%9C/audio/click.mp3?raw=true"),this.events()}events(){this.initializeAppearance(),this.btnElements.forEach(el=>{el.addEventListener("click",e=>this.runButtonFunctions(e)),document.body.clientWidth<=1024?el.addEventListener("touchstart",()=>this.playSound()):el.addEventListener("mousedown",()=>this.playSound())})}initializeAppearance(){this.inputElement.textContent="",this.resultElement.textContent="0",this.fontSizeAdjust()}runButtonFunctions(e){if(!this.textviewElement.classList.contains("allclear")){if(0===this.inputArray.length){if("C"===e.target.textContent||"☞"===e.target.textContent||"="===e.target.textContent||"O"===e.target.textContent)return;"%"!==e.target.textContent&&"÷"!==e.target.textContent&&"✕"!==e.target.textContent&&"–"!==e.target.textContent&&"＋"!==e.target.textContent&&"."!==e.target.textContent||this.inputArray.push("0")}if("C"===e.target.textContent)return this.clearAll();if("☞"===e.target.textContent)return this.clearOne();if("="===e.target.textContent)return this.equals();this.replacePreviousOperator(e),this.preventNumberStartWithZero(e),this.showInput(e.target.textContent);try{this.showResult()}catch(error){}this.fontSizeAdjust()}}replacePreviousOperator(e){const lastItem=this.inputArray[this.inputArray.length-1];"%"!==e.target.textContent&&"÷"!==e.target.textContent&&"✕"!==e.target.textContent&&"–"!==e.target.textContent&&"＋"!==e.target.textContent&&"."!==e.target.textContent||" ÷ "!==lastItem&&" X "!==lastItem&&" – "!==lastItem&&" ＋ "!==lastItem&&"."!==lastItem||this.inputArray.length--}preventNumberStartWithZero(e){const lastItem=this.inputArray[this.inputArray.length-1],lastSecondItem=this.inputArray[this.inputArray.length-2];"O"!==e.target.textContent&&"1"!==e.target.textContent&&"2"!==e.target.textContent&&"3"!==e.target.textContent&&"4"!==e.target.textContent&&"5"!==e.target.textContent&&"6"!==e.target.textContent&&"7"!==e.target.textContent&&"8"!==e.target.textContent&&"9"!==e.target.textContent||("0"===lastItem&&" ÷ "===lastSecondItem||"0"===lastItem&&" X "===lastSecondItem||"0"===lastItem&&" – "===lastSecondItem||"0"===lastItem&&" ＋ "===lastSecondItem||"0"===lastItem&&"%"===lastSecondItem)&&this.inputArray.length--}clearAll(){this.textviewElement.classList.add("allclear"),setTimeout(()=>{this.inputArray=[],this.initializeAppearance(),this.textviewElement.classList.remove("allclear")},700)}clearOne(){if(0!==this.inputArray.length){if(1===this.inputArray.length)return this.inputArray=[],this.inputElement.textContent="",this.resultElement.textContent="0",void this.fontSizeAdjust();this.inputArray.length--,this.evalCalculationCorrect(),this.inputElement.textContent=this.inputArray.join(""),this.showResult(),this.recoveryDeletedOperator(),this.fontSizeAdjust()}}evalCalculationCorrect(){const lastItem=this.inputArray[this.inputArray.length-1];" ÷ "!==lastItem&&" X "!==lastItem&&" – "!==lastItem&&" ＋ "!==lastItem&&"."!==lastItem||(this.tempOperator=lastItem,this.inputArray.length--)}recoveryDeletedOperator(){this.tempOperator.length&&(this.inputArray.push(this.tempOperator),this.inputElement.textContent=this.inputArray.join(""),this.tempOperator="")}equals(){if(this.inputElement.textContent="","0"===this.resultElement.textContent)this.inputArray=[];else{const numWithThreeFloat=Math.round(1e3*this.resultElement.textContent.replace(/,/g,""))/1e3;this.inputArray=numWithThreeFloat.toString().split(""),this.showResult(),this.fontSizeAdjust()}}showInput(text){this.inputArray.push(text.replace("O","0").replace("÷"," ÷ ").replace("✕"," X ").replace("–"," – ").replace("＋"," ＋ ")),this.inputElement.textContent=this.inputArray.join("")}showResult(){const calculatableString=this.inputArray.join("").replace(/÷/g,"/").replace(/X/g,"*").replace(/–/g,"-").replace(/＋/g,"+").replace(/%/g,"* 0.01").replace(/[^-()\d/*+.]/g,""),resultNumber=Math.round(1e12*eval(calculatableString))/1e12;this.resultElement.textContent=this.thousandFormat(resultNumber)}thousandFormat(num){const parts=num.toString().split(".");return parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),parts.join(".")}fontSizeAdjust(){const resultLength=this.resultElement.textContent.length;return resultLength>15?(this.resultElement.classList.remove("mediumText"),this.resultElement.classList.remove("smallText"),void this.resultElement.classList.add("verySmallText")):resultLength>11?(this.resultElement.classList.remove("mediumText"),this.resultElement.classList.add("smallText"),void this.resultElement.classList.remove("verySmallText")):resultLength>7?(this.resultElement.classList.add("mediumText"),this.resultElement.classList.remove("smallText"),void this.resultElement.classList.remove("verySmallText")):(this.resultElement.classList.remove("mediumText"),this.resultElement.classList.remove("smallText"),void this.resultElement.classList.remove("verySmallText"))}playSound(){this.clickSound.currentTime=0,this.clickSound.play()}}new Calculator;